# UserParameter для виджетов дашборда. Вывод в стиле CLI (как в терминале).
# Требуется docker-cli и jq в образе агента (Dockerfile.agent2). DOCKER_HOST — сокет хоста.
UserParameter=docker.services.list,DOCKER_HOST=unix:///var/run/docker.sock /usr/bin/docker service ls --format "table {{.ID}}\t{{.Name}}\t{{.Mode}}\t{{.Replicas}}\t{{.Image}}" 2>/dev/null | head -c 65535 || echo "N/A"
UserParameter=docker.containers.exited.list,DOCKER_HOST=unix:///var/run/docker.sock /usr/bin/docker ps -a --filter status=exited --format "table {{.ID}}\t{{.Names}}\t{{.Status}}" 2>/dev/null | head -c 65535 || echo "N/A"
UserParameter=docker.swarm.state,curl -s --unix-socket /var/run/docker.sock "http://localhost/info" 2>/dev/null | grep -o '"LocalNodeState":"[^"]*"' | head -1 | cut -d'"' -f4 || true
# Диск: только «объём тома / свободно» (одна строка)
UserParameter=hostfs.disk.summary,df -B1 /hostfs 2>/dev/null | awk 'NR==2{free=$4; total=$2; printf "%.1f GB / %.1f GB свободно", total/1024/1024/1024, free/1024/1024/1024}' || echo "N/A"
